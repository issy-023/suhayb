{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/web.dom-exception.stack.js\";\nimport SockJS from \"sockjs-client\";\nimport { Stomp } from \"@stomp/stompjs\";\nexport default {\n  data() {\n    return {\n      isConnecting: true,\n      usernameInput: \"\",\n      messageInput: \"\",\n      messages: [],\n      stompClient: null,\n      hasLeft: false,\n      hasJoined: false,\n      colors: [\"#2196F3\", \"#32c787\", \"#00BCD4\", \"#ff5652\", \"#ffc107\", \"#ff85af\", \"#FF9800\", \"#39bbb0\"],\n      maxCharacters: 220,\n      token: \"\",\n      // Token van de gebruiker\n      showLoginPopup: false // Nieuw: Beheert de zichtbaarheid van de popup\n    };\n  },\n  computed: {\n    remainingCharacters() {\n      return this.maxCharacters - this.messageInput.length;\n    }\n  },\n  methods: {\n    loadUsername() {\n      const token = localStorage.getItem(\"token\");\n      if (token) {\n        this.token = token;\n        const payload = JSON.parse(atob(token.split('.')[1]));\n        this.usernameInput = payload.username || `Anonymous${Math.floor(Math.random() * 1000)}`;\n      } else {\n        this.usernameInput = \"You are not logged in\";\n      }\n      localStorage.setItem(\"username\", this.usernameInput);\n    },\n    async loadRecentMessages() {\n      try {\n        const token = localStorage.getItem(\"token\");\n        const headers = token ? {\n          Authorization: `Bearer ${token}`,\n          \"Content-Type\": \"application/json\"\n        } : {\n          \"Content-Type\": \"application/json\"\n        };\n        const response = await fetch(\"http://localhost:8084/api/chat/recentMessages\", {\n          method: \"GET\",\n          headers\n        });\n        if (response.ok) {\n          const data = await response.json();\n          this.messages = data.map(message => ({\n            ...message,\n            isOwnMessage: message.sender === this.usernameInput\n          }));\n        } else {\n          console.error(\"Failed to load recent messages.\");\n        }\n      } catch (error) {\n        console.error(\"Error loading recent messages:\", error);\n      }\n    },\n    connect() {\n      if (this.usernameInput.trim() && !this.stompClient?.active) {\n        this.hasLeft = false;\n        const socket = new SockJS(\"http://localhost:8084/ws\");\n        this.stompClient = Stomp.over(socket);\n        this.stompClient.reconnectDelay = 5000;\n        this.stompClient.onConnect = this.onConnected;\n        this.stompClient.onStompError = this.onError;\n        this.stompClient.activate();\n      }\n    },\n    joinChat() {\n      if (!this.token) {\n        // Toon de popup in plaats van een alert\n        this.showLoginPopup = true;\n        return;\n      }\n      if (!this.hasJoined) {\n        this.hasJoined = true;\n        this.stompClient.send(\"/app/chat.addUser\", {\n          Authorization: `Bearer ${this.token}`\n        }, JSON.stringify({\n          sender: this.usernameInput,\n          type: \"JOIN\"\n        }));\n      }\n    },\n    sendMessage() {\n      const messageContent = this.messageInput.trim();\n      if (messageContent && this.remainingCharacters >= 0 && this.stompClient && this.stompClient.active) {\n        const chatMessage = {\n          sender: this.usernameInput,\n          content: messageContent,\n          type: \"CHAT\"\n        };\n        this.stompClient.send(\"/app/chat.sendMessage\", {\n          Authorization: `Bearer ${this.token}`\n        }, JSON.stringify(chatMessage));\n        this.messageInput = \"\";\n      }\n    },\n    leaveChat() {\n      if (this.stompClient && this.stompClient.active && this.hasJoined) {\n        this.stompClient.send(\"/app/chat.addUser\", {}, JSON.stringify({\n          sender: this.usernameInput,\n          type: \"LEAVE\"\n        }));\n        this.hasLeft = true;\n        this.hasJoined = false;\n      }\n      this.stompClient.deactivate();\n    },\n    closePopup() {\n      this.showLoginPopup = false;\n    },\n    onConnected() {\n      this.stompClient.subscribe(\"/topic/public\", this.onMessageReceived);\n      this.isConnecting = false;\n    },\n    onError(error) {\n      console.error(\"WebSocket Error:\", error);\n      this.isConnecting = true;\n    },\n    onMessageReceived(payload) {\n      const message = JSON.parse(payload.body);\n      message.isOwnMessage = message.sender === this.usernameInput;\n      if (message.type === \"JOIN\") {\n        message.content = `${message.sender} joined!`;\n      } else if (message.type === \"LEAVE\") {\n        message.content = `${message.sender} left!`;\n      }\n      this.messages.push(message);\n      if (this.messages.length > 20) {\n        this.messages.shift(); // Verwijder het oudste bericht om alleen de laatste 20 berichten te behouden\n      }\n      this.$nextTick(() => {\n        const messageArea = this.$refs.messageArea;\n        if (messageArea) {\n          messageArea.scrollTop = messageArea.scrollHeight;\n        }\n      });\n    },\n    getAvatarColor(messageSender) {\n      let hash = 0;\n      for (let i = 0; i < messageSender.length; i++) {\n        hash = 31 * hash + messageSender.charCodeAt(i);\n      }\n      const index = Math.abs(hash % this.colors.length);\n      return this.colors[index];\n    },\n    checkCharacterLimit() {\n      if (this.messageInput.length > this.maxCharacters) {\n        this.messageInput = this.messageInput.substring(0, this.maxCharacters);\n      }\n    }\n  },\n  mounted() {\n    this.token = localStorage.getItem(\"token\");\n    this.loadUsername();\n    this.connect();\n    this.loadRecentMessages();\n  },\n  beforeUnmount() {\n    if (this.stompClient && this.stompClient.active) {\n      this.leaveChat();\n      this.stompClient.deactivate();\n    }\n  }\n};","map":{"version":3,"names":["SockJS","Stomp","data","isConnecting","usernameInput","messageInput","messages","stompClient","hasLeft","hasJoined","colors","maxCharacters","token","showLoginPopup","computed","remainingCharacters","length","methods","loadUsername","localStorage","getItem","payload","JSON","parse","atob","split","username","Math","floor","random","setItem","loadRecentMessages","headers","Authorization","response","fetch","method","ok","json","map","message","isOwnMessage","sender","console","error","connect","trim","active","socket","over","reconnectDelay","onConnect","onConnected","onStompError","onError","activate","joinChat","send","stringify","type","sendMessage","messageContent","chatMessage","content","leaveChat","deactivate","closePopup","subscribe","onMessageReceived","body","push","shift","$nextTick","messageArea","$refs","scrollTop","scrollHeight","getAvatarColor","messageSender","hash","i","charCodeAt","index","abs","checkCharacterLimit","substring","mounted","beforeUnmount"],"sources":["/Users/suhayb/Documenten/cuuruuvoovii16/election-frontend/src/components/LiveChatPageComponent.vue"],"sourcesContent":["<template>\n  <div>\n    <noscript>\n      <h2>Sorry! Your browser doesn't support Javascript</h2>\n    </noscript>\n\n    <div class=\"chat-page\">\n      <div class=\"chat-container\">\n        <div class=\"chat-header\">\n          <h2>LiveChatPage</h2>\n          <h3>{{ usernameInput }}</h3>\n          <button @click=\"leaveChat\" class=\"leave-button\" v-if=\"hasJoined\">Leave</button>\n        </div>\n        <div class=\"connecting\" v-show=\"isConnecting\">\n          Connecting...\n        </div>\n        <ul class=\"message-area\" ref=\"messageArea\">\n          <li\n              v-for=\"(message, index) in messages\"\n              :key=\"index\"\n              :class=\"[\n                'message-container',\n                message.isOwnMessage ? 'own-message-container' : 'other-message-container'\n              ]\"\n          >\n            <div :class=\"message.isOwnMessage ? 'own-message' : 'other-message'\">\n              <template v-if=\"message.type === 'CHAT'\">\n                <i :style=\"{ backgroundColor: getAvatarColor(message.sender) }\">\n                  {{ message.sender[0] }}\n                </i>\n                <span class=\"sender-name\">{{ message.sender }}</span>\n              </template>\n              <p class=\"message-content\">{{ message.content }}</p>\n            </div>\n          </li>\n        </ul>\n\n        <!-- Formulier om berichten te versturen, alleen zichtbaar na 'Join' -->\n        <form @submit.prevent=\"sendMessage\" v-if=\"hasJoined\">\n          <div class=\"form-group\">\n            <div class=\"input-group clearfix\">\n              <input\n                  type=\"text\"\n                  v-model=\"messageInput\"\n                  placeholder=\"Type a message...\"\n                  autocomplete=\"off\"\n                  class=\"form-control\"\n                  @input=\"checkCharacterLimit\"\n              />\n              <button type=\"submit\" class=\"primary\" :disabled=\"remainingCharacters < 0\">Send</button>\n            </div>\n            <p class=\"character-count\" :class=\"{ 'over-limit': remainingCharacters < 0 }\">\n              Characters left: {{ remainingCharacters }}\n            </p>\n          </div>\n        </form>\n\n        <!-- Join-knop onderaan de chat, alleen zichtbaar als de gebruiker niet gejoined is -->\n        <button v-if=\"!hasJoined\" @click=\"joinChat\" class=\"join-button\">\n          Join\n        </button>\n      </div>\n\n      <!-- Popup -->\n      <div v-if=\"showLoginPopup\" class=\"popup-overlay\">\n        <div class=\"popup\">\n          <h3>You need to log in to chat</h3>\n          <p>Please log in to participate in the chat.</p>\n          <a href=\"/login\" class=\"login-link\">Go to Login Page</a>\n          <button @click=\"closePopup\" class=\"close-button\">Close</button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n\n\n<script>\nimport SockJS from \"sockjs-client\";\nimport { Stomp } from \"@stomp/stompjs\";\n\nexport default {\n  data() {\n    return {\n      isConnecting: true,\n      usernameInput: \"\",\n      messageInput: \"\",\n      messages: [],\n      stompClient: null,\n      hasLeft: false,\n      hasJoined: false,\n      colors: [\"#2196F3\", \"#32c787\", \"#00BCD4\", \"#ff5652\", \"#ffc107\", \"#ff85af\", \"#FF9800\", \"#39bbb0\"],\n      maxCharacters: 220,\n      token: \"\", // Token van de gebruiker\n      showLoginPopup: false, // Nieuw: Beheert de zichtbaarheid van de popup\n    };\n  },\n\n  computed: {\n    remainingCharacters() {\n      return this.maxCharacters - this.messageInput.length;\n    }\n  },\n  methods: {\n    loadUsername() {\n      const token = localStorage.getItem(\"token\");\n\n      if (token) {\n        this.token = token;\n        const payload = JSON.parse(atob(token.split('.')[1]));\n        this.usernameInput = payload.username || `Anonymous${Math.floor(Math.random() * 1000)}`;\n      } else {\n        this.usernameInput = \"You are not logged in\";\n      }\n\n      localStorage.setItem(\"username\", this.usernameInput);\n    },\n\n    async loadRecentMessages() {\n      try {\n        const token = localStorage.getItem(\"token\");\n        const headers = token\n            ? { Authorization: `Bearer ${token}`, \"Content-Type\": \"application/json\" }\n            : { \"Content-Type\": \"application/json\" };\n\n        const response = await fetch(\"http://localhost:8084/api/chat/recentMessages\", {\n          method: \"GET\",\n          headers,\n        });\n\n        if (response.ok) {\n          const data = await response.json();\n          this.messages = data.map((message) => ({\n            ...message,\n            isOwnMessage: message.sender === this.usernameInput,\n          }));\n        } else {\n          console.error(\"Failed to load recent messages.\");\n        }\n      } catch (error) {\n        console.error(\"Error loading recent messages:\", error);\n      }\n    },\n\n    connect() {\n      if (this.usernameInput.trim() && !this.stompClient?.active) {\n        this.hasLeft = false;\n\n        const socket = new SockJS(\"http://localhost:8084/ws\");\n        this.stompClient = Stomp.over(socket);\n        this.stompClient.reconnectDelay = 5000;\n        this.stompClient.onConnect = this.onConnected;\n        this.stompClient.onStompError = this.onError;\n\n        this.stompClient.activate();\n      }\n    },\n\n    joinChat() {\n      if (!this.token) {\n        // Toon de popup in plaats van een alert\n        this.showLoginPopup = true;\n        return;\n      }\n\n      if (!this.hasJoined) {\n        this.hasJoined = true;\n\n        this.stompClient.send(\n            \"/app/chat.addUser\",\n            { Authorization: `Bearer ${this.token}` },\n            JSON.stringify({ sender: this.usernameInput, type: \"JOIN\" })\n        );\n      }\n    },\n\n    sendMessage() {\n      const messageContent = this.messageInput.trim();\n      if (messageContent && this.remainingCharacters >= 0 && this.stompClient && this.stompClient.active) {\n        const chatMessage = {\n          sender: this.usernameInput,\n          content: messageContent,\n          type: \"CHAT\",\n        };\n\n        this.stompClient.send(\"/app/chat.sendMessage\", { Authorization: `Bearer ${this.token}` }, JSON.stringify(chatMessage));\n        this.messageInput = \"\";\n      }\n    },\n\n    leaveChat() {\n      if (this.stompClient && this.stompClient.active && this.hasJoined) {\n        this.stompClient.send(\n            \"/app/chat.addUser\",\n            {},\n            JSON.stringify({ sender: this.usernameInput, type: \"LEAVE\" })\n        );\n        this.hasLeft = true;\n        this.hasJoined = false;\n      }\n      this.stompClient.deactivate();\n    },\n\n    closePopup() {\n      this.showLoginPopup = false;\n    },\n\n    onConnected() {\n      this.stompClient.subscribe(\"/topic/public\", this.onMessageReceived);\n      this.isConnecting = false;\n    },\n\n    onError(error) {\n      console.error(\"WebSocket Error:\", error);\n      this.isConnecting = true;\n    },\n\n    onMessageReceived(payload) {\n      const message = JSON.parse(payload.body);\n      message.isOwnMessage = message.sender === this.usernameInput;\n\n      if (message.type === \"JOIN\") {\n        message.content = `${message.sender} joined!`;\n      } else if (message.type === \"LEAVE\") {\n        message.content = `${message.sender} left!`;\n      }\n\n      this.messages.push(message);\n\n      if (this.messages.length > 20) {\n        this.messages.shift(); // Verwijder het oudste bericht om alleen de laatste 20 berichten te behouden\n      }\n\n      this.$nextTick(() => {\n        const messageArea = this.$refs.messageArea;\n        if (messageArea) {\n          messageArea.scrollTop = messageArea.scrollHeight;\n        }\n      });\n    },\n\n    getAvatarColor(messageSender) {\n      let hash = 0;\n      for (let i = 0; i < messageSender.length; i++) {\n        hash = 31 * hash + messageSender.charCodeAt(i);\n      }\n      const index = Math.abs(hash % this.colors.length);\n      return this.colors[index];\n    },\n\n    checkCharacterLimit() {\n      if (this.messageInput.length > this.maxCharacters) {\n        this.messageInput = this.messageInput.substring(0, this.maxCharacters);\n      }\n    }\n  },\n  mounted() {\n    this.token = localStorage.getItem(\"token\");\n    this.loadUsername();\n    this.connect();\n    this.loadRecentMessages();\n  },\n  beforeUnmount() {\n    if (this.stompClient && this.stompClient.active) {\n      this.leaveChat();\n      this.stompClient.deactivate();\n    }\n  }\n};\n</script>\n\n\n<style scoped>\n* {\n  box-sizing: border-box;\n}\n\nhtml, body {\n  height: 100%;\n  overflow: hidden;\n}\n\nbody {\n  margin: 0;\n  padding: 0;\n  font-weight: 400;\n  font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif;\n  font-size: 1rem;\n  line-height: 1.58;\n  color: #333;\n  background-color: #f4f4f4;\n  height: 100%;\n}\n\n.chat-page {\n  position: relative;\n  height: 100%;\n}\n\n.chat-container {\n  max-width: 700px;\n  margin: 30px auto;\n  background-color: #fff;\n  box-shadow: 0 1px 11px rgba(0, 0, 0, 0.27);\n  height: 600px;\n  max-height: 600px;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n}\n\n.chat-header {\n  text-align: center;\n  padding: 15px;\n  border-bottom: 1px solid #ececec;\n}\n\n.connecting {\n  padding-top: 5px;\n  text-align: center;\n  color: #777;\n  position: absolute;\n  top: 65px;\n  width: 100%;\n}\n\n.message-area {\n  list-style-type: none;\n  background-color: #FFF;\n  margin: 0;\n  overflow-y: auto;\n  padding: 0 20px;\n  flex-grow: 1;\n}\n\n.message-container {\n  padding: 10px;\n  border-radius: 8px;\n  margin: 5px 0;\n  max-width: 60%;\n  display: flex;\n  flex-direction: column;\n}\n\n.own-message-container {\n  align-self: flex-end;\n  background-color: #d4f5d4;\n}\n\n.other-message-container {\n  align-self: flex-start;\n  background-color: #e1e1e1;\n}\n\n.own-message,\n.other-message {\n  display: flex;\n  flex-direction: column;\n}\n\n.own-message i,\n.other-message i {\n  margin-right: 10px;\n  color: #fff;\n  text-align: center;\n  border-radius: 50%;\n  font-style: normal;\n  text-transform: uppercase;\n  width: 32px;\n  height: 32px;\n  line-height: 32px;\n}\n\n.sender-name {\n  font-weight: bold;\n  display: block;\n  margin-bottom: 4px;\n}\n\n.message-content {\n  margin: 0;\n  padding: 8px;\n  word-wrap: break-word;\n}\n\n.form-control {\n  width: 100%;\n  min-height: 38px;\n  font-size: 15px;\n  border: 1px solid #c8c8c8;\n}\n\n.form-group {\n  margin-bottom: 15px;\n}\n\ninput {\n  padding-left: 10px;\n  outline: none;\n}\n\nbutton {\n  box-shadow: none;\n  border: 1px solid transparent;\n  font-size: 14px;\n  outline: none;\n  line-height: 100%;\n  white-space: nowrap;\n  vertical-align: middle;\n  padding: 0.6rem 1rem;\n  border-radius: 2px;\n  transition: all 0.2s ease-in-out;\n  cursor: pointer;\n  min-height: 38px;\n}\n\nbutton.primary {\n  background-color: #6db33f;\n  color: #fff;\n}\n\nbutton.accent {\n  background-color: #6db33f;\n  color: #fff;\n}\n\n.leave-button {\n  background-color: #ff4d4d;\n  color: #fff;\n  border: none;\n  padding: 8px 12px;\n  border-radius: 5px;\n  cursor: pointer;\n  position: absolute;\n  bottom: 10px;\n  right: 10px;\n}\n\n.leave-button:hover {\n  background-color: #ff3333;\n}\n\n/* Stijlen voor de Join-knop in de chat-container */\n.join-button {\n  background-color: #6db33f; /* Groene achtergrondkleur */\n  color: #fff; /* Witte tekstkleur */\n  padding: 10px 20px;\n  font-size: 16px;\n  font-weight: bold;\n  border: none;\n  border-radius: 5px;\n  cursor: pointer;\n  transition: background-color 0.3s ease;\n  margin: 10px auto 20px; /* Plaats de knop gecentreerd onderaan */\n  width: 80%;\n  text-align: center;\n}\n\n.join-button:hover {\n  background-color: #5a9e2c; /* Donkergroen bij hover */\n}\n\n/* Popup-styling */\n.popup-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.6);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n}\n\n.popup {\n  background: #fff;\n  padding: 20px;\n  border-radius: 10px;\n  text-align: center;\n  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);\n  width: 300px;\n}\n\n.popup h3 {\n  margin: 0 0 10px;\n  font-size: 18px;\n}\n\n.popup p {\n  margin: 0 0 20px;\n  font-size: 16px;\n}\n\n.popup .login-link,\n.popup .close-button {\n  display: block; /* Zorg ervoor dat beide knoppen een blokvorm hebben */\n  width: 100%; /* Maak de knoppen 100% breed */\n  margin: 10px 0; /* Voeg verticale ruimte toe tussen de knoppen */\n  padding: 10px 20px;\n  text-align: center;\n  border-radius: 5px;\n  text-decoration: none;\n  font-size: 16px;\n  cursor: pointer;\n}\n\n.popup .login-link {\n  background: #6db33f;\n  color: #fff;\n  transition: background 0.3s ease;\n  border: none;\n}\n\n.popup .login-link:hover {\n  background: #5a9e2c;\n}\n\n.popup .close-button {\n  background: #ff4d4d;\n  color: #fff;\n  border: none;\n  transition: background 0.3s ease;\n}\n\n.popup .close-button:hover {\n  background: #ff3333;\n}\n\n\n@media screen and (max-width: 730px) {\n  .chat-container {\n    margin-left: 10px;\n    margin-right: 10px;\n    margin-top: 10px;\n  }\n}\n\n@media screen and (max-width: 480px) {\n  .chat-container {\n    height: calc(100% - 30px);\n  }\n\n  .message-area {\n    height: calc(100% - 120px);\n  }\n\n  .chat-header {\n    padding: 10px;\n  }\n\n  .connecting {\n    top: 60px;\n  }\n\n  .chat-header h2 {\n    font-size: 1.1em;\n  }\n\n  .character-count {\n    font-size: 14px;\n    color: #666;\n    margin-top: 5px;\n    text-align: right;\n  }\n\n  .over-limit {\n    color: red;\n  }\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}